# Intentionally Vulnerable Kubernetes Secrets Configuration
# For testing Nubicustos K8s scanners

# VULN: Secret with no encryption at rest (assuming etcd encryption not enabled)
apiVersion: v1
kind: Secret
metadata:
  name: database-credentials
  namespace: default
type: Opaque
# VULN: Base64 encoded secrets (easily decoded)
data:
  # echo -n 'admin' | base64
  username: YWRtaW4=
  # echo -n 'SuperSecretPassword123!' | base64
  password: U3VwZXJTZWNyZXRQYXNzd29yZDEyMyE=
  # echo -n 'mysql://admin:SuperSecretPassword123!@db.example.com:3306/mydb' | base64
  connection-string: bXlzcWw6Ly9hZG1pbjpTdXBlclNlY3JldFBhc3N3b3JkMTIzIUBkYi5leGFtcGxlLmNvbTozMzA2L215ZGI=

---
# VULN: AWS credentials in secret
apiVersion: v1
kind: Secret
metadata:
  name: aws-credentials
  namespace: default
type: Opaque
stringData:
  # VULN: Hardcoded AWS credentials
  AWS_ACCESS_KEY_ID: "AKIAIOSFODNN7EXAMPLE"
  AWS_SECRET_ACCESS_KEY: "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
  AWS_SESSION_TOKEN: "FwoGZXIvYXdzEBYaDH..."

---
# VULN: API keys in secret
apiVersion: v1
kind: Secret
metadata:
  name: api-keys
  namespace: default
type: Opaque
stringData:
  stripe-key: "sk_live_1234567890abcdef"
  github-token: "ghp_1234567890abcdefghijklmnopqrstuvwxyz"
  slack-webhook: "https://example.com/fake-webhook-for-testing"
  jwt-secret: "super-secret-jwt-signing-key-that-should-not-be-here"

---
# VULN: TLS certificate and key in plain secret
apiVersion: v1
kind: Secret
metadata:
  name: tls-secret
  namespace: default
type: kubernetes.io/tls
stringData:
  tls.crt: |
    -----BEGIN CERTIFICATE-----
    MIICpDCCAYwCCQDU+pQ4P3hY0DANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAls
    b2NhbGhvc3QwHhcNMjMwMTAxMDAwMDAwWhcNMjQwMTAxMDAwMDAwWjAUMRIwEAYD
    VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC7
    -----END CERTIFICATE-----
  tls.key: |
    -----BEGIN PRIVATE KEY-----
    MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC7
    VULNERABLE_PRIVATE_KEY_CONTENT_HERE
    -----END PRIVATE KEY-----

---
# VULN: ConfigMap with sensitive data (should be Secret)
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default
data:
  # VULN: Sensitive data in ConfigMap instead of Secret
  database.properties: |
    db.host=db.example.com
    db.port=3306
    db.name=production
    db.username=admin
    db.password=ProductionPassword123!

  # VULN: API configuration with keys
  api.properties: |
    api.key=sk-prod-1234567890
    api.secret=super-secret-value
    encryption.key=AES256-encryption-key-here
