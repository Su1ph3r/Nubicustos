import{_ as F,r as g,j as V,k as $,a as o,e as s,f as r,x as d,u as l,I as v,t as e,q as D,M as x,V as B,F as L,C as N,z as P,o as a}from"./index-D2tkqljB.js";import{u as q}from"./scans-De8fIZ3u.js";import{s as A}from"./progressbar.esm-BF4X16V2.js";const M={class:"scan-detail-view"},E={class:"page-header"},I={class:"header-content"},R={class:"subtitle"},T={key:0,class:"header-actions"},j={key:0,class:"loading-container"},z={class:"section"},H={class:"info-grid"},U={class:"info-card"},G={class:"info-value"},J={class:"info-card"},K={class:"info-value"},O={class:"info-card"},Q={class:"info-value"},W={class:"info-card"},X={class:"info-value"},Y={key:0,class:"section"},Z={class:"findings-grid"},ss={class:"finding-card critical"},is={class:"finding-count"},ns={class:"finding-card high"},ts={class:"finding-count"},es={class:"finding-card medium"},as={class:"finding-count"},os={class:"finding-card low"},ls={class:"finding-count"},ds={class:"findings-actions"},cs={key:1,class:"section"},rs={class:"progress-card"},us={key:2,class:"section"},vs={class:"logs-container"},fs={key:2,class:"empty-state"},gs={__name:"ScanDetailView",props:{id:{type:String,required:!0}},setup(y){const c=y;N();const S=P(),u=q(),n=g(null),p=g(null),f=g(!0);function k(t){return{running:"info",completed:"success",failed:"danger",cancelled:"warning",pending:"secondary"}[t]||"secondary"}function _(t){return t?new Date(t).toLocaleString():"-"}async function h(){var t;f.value=!0;try{n.value=await u.fetchScan(c.id),((t=n.value)==null?void 0:t.status)==="running"&&u.startPolling(c.id,i=>{n.value=i})}catch(i){console.error("Failed to load scan:",i)}finally{f.value=!1}}async function b(){try{await u.cancelScan(c.id),n.value.status="cancelled"}catch(t){console.error("Failed to cancel scan:",t)}}function w(){S.push({path:"/findings",query:{scan_id:c.id}})}return V(()=>{h()}),$(()=>{u.stopPolling(c.id)}),(t,i)=>{var m;return a(),o("div",M,[s("div",E,[s("div",I,[d(l(v),{icon:"pi pi-arrow-left",text:"",onClick:i[0]||(i[0]=C=>t.$router.push("/scans")),class:"back-btn"}),s("div",null,[i[2]||(i[2]=s("h1",null,"Scan Details",-1)),s("p",R,e(((m=n.value)==null?void 0:m.scan_id)||"Loading..."),1)])]),n.value?(a(),o("div",T,[d(l(x),{severity:k(n.value.status),value:n.value.status},null,8,["severity","value"]),n.value.status==="running"?(a(),D(l(v),{key:0,label:"Cancel Scan",icon:"pi pi-stop",severity:"danger",onClick:b})):r("",!0)])):r("",!0)]),f.value?(a(),o("div",j,[d(l(B)),i[3]||(i[3]=s("span",null,"Loading scan details...",-1))])):n.value?(a(),o(L,{key:1},[s("section",z,[s("div",H,[s("div",U,[i[4]||(i[4]=s("div",{class:"info-label"},"Profile",-1)),s("div",G,e(n.value.scan_type||n.value.tool||"N/A"),1)]),s("div",J,[i[5]||(i[5]=s("div",{class:"info-label"},"Target",-1)),s("div",K,e(n.value.target||"All resources"),1)]),s("div",O,[i[6]||(i[6]=s("div",{class:"info-label"},"Started",-1)),s("div",Q,e(_(n.value.started_at)),1)]),s("div",W,[i[7]||(i[7]=s("div",{class:"info-label"},"Completed",-1)),s("div",X,e(n.value.completed_at?_(n.value.completed_at):"-"),1)])])]),n.value.status==="completed"?(a(),o("section",Y,[i[12]||(i[12]=s("h2",{class:"section-title"},"Findings Summary",-1)),s("div",Z,[s("div",ss,[s("div",is,e(n.value.critical_findings||0),1),i[8]||(i[8]=s("div",{class:"finding-label"},"Critical",-1))]),s("div",ns,[s("div",ts,e(n.value.high_findings||0),1),i[9]||(i[9]=s("div",{class:"finding-label"},"High",-1))]),s("div",es,[s("div",as,e(n.value.medium_findings||0),1),i[10]||(i[10]=s("div",{class:"finding-label"},"Medium",-1))]),s("div",os,[s("div",ls,e(n.value.low_findings||0),1),i[11]||(i[11]=s("div",{class:"finding-label"},"Low",-1))])]),s("div",ds,[d(l(v),{label:"View All Findings",icon:"pi pi-list",onClick:w})])])):r("",!0),n.value.status==="running"?(a(),o("section",cs,[i[14]||(i[14]=s("h2",{class:"section-title"},"Scan Progress",-1)),s("div",rs,[d(l(A),{mode:"indeterminate"}),i[13]||(i[13]=s("p",null,"Scan is running. This may take several minutes depending on the profile.",-1))])])):r("",!0),p.value?(a(),o("section",us,[i[15]||(i[15]=s("h2",{class:"section-title"},"Execution Logs",-1)),s("div",vs,[s("pre",null,e(p.value),1)])])):r("",!0)],64)):(a(),o("div",fs,[i[16]||(i[16]=s("i",{class:"pi pi-exclamation-circle"},null,-1)),i[17]||(i[17]=s("p",null,"Scan not found",-1)),d(l(v),{label:"Back to Scans",onClick:i[1]||(i[1]=C=>t.$router.push("/scans"))})]))])}}},ys=F(gs,[["__scopeId","data-v-cf32f092"]]);export{ys as default};
