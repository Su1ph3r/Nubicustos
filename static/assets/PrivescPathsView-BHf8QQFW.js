import{d as M,r as h,c as P,_ as V,j as z,a as x,e as o,f as b,x as r,q as j,u as a,t as w,A as y,J as A,K as B,o as k,L as v,M as F,I as S}from"./index-D2tkqljB.js";import{s as I}from"./progressbar.esm-BF4X16V2.js";const _="/api",L=M("privescPaths",()=>{const f=h([]),s=h(null),m=h(null),p=h(!1),c=h(null),d=h({page:1,pageSize:50,total:0}),t=h({minRiskScore:null,escalationMethod:null,cloudProvider:null,exploitability:null,status:"open"}),i=P(()=>f.value.filter(e=>e.risk_score>=80)),l=P(()=>f.value.filter(e=>e.risk_score>=60&&e.risk_score<80));async function g(){p.value=!0,c.value=null;try{const e=new URLSearchParams;e.append("page",d.value.page),e.append("page_size",d.value.pageSize),t.value.minRiskScore!==null&&e.append("min_risk_score",t.value.minRiskScore),t.value.escalationMethod&&e.append("escalation_method",t.value.escalationMethod),t.value.cloudProvider&&e.append("cloud_provider",t.value.cloudProvider),t.value.exploitability&&e.append("exploitability",t.value.exploitability),t.value.status&&e.append("status",t.value.status);const n=await fetch(`${_}/privesc-paths?${e}`);if(!n.ok)throw new Error("Failed to fetch privesc paths");const u=await n.json();f.value=u.paths,d.value.total=u.total}catch(e){c.value=e.message,console.error("Error fetching privesc paths:",e)}finally{p.value=!1}}async function $(e){p.value=!0,c.value=null;try{const n=await fetch(`${_}/privesc-paths/${e}`);if(!n.ok)throw new Error("Failed to fetch path");return s.value=await n.json(),s.value}catch(n){return c.value=n.message,null}finally{p.value=!1}}async function E(){try{const e=await fetch(`${_}/privesc-paths/summary`);if(!e.ok)throw new Error("Failed to fetch summary");return m.value=await e.json(),m.value}catch(e){return console.error("Error fetching summary:",e),null}}async function R(e,n="markdown"){try{const u=await fetch(`${_}/privesc-paths/${e}/export?format=${n}`);if(!u.ok)throw new Error("Export failed");return await u.json()}catch(u){throw c.value=u.message,u}}function C(e){t.value={...t.value,...e},d.value.page=1,g()}return{paths:f,currentPath:s,summary:m,loading:p,error:c,pagination:d,filters:t,criticalPaths:i,highRiskPaths:l,fetchPaths:g,fetchPath:$,fetchSummary:E,exportPath:R,setFilters:C}}),N={class:"privesc-paths-view"},T={key:0,class:"summary-cards"},q={class:"summary-card critical"},D={class:"card-value"},H={class:"summary-card high"},J={class:"card-value"},K={class:"summary-card info"},U={class:"card-value"},G={__name:"PrivescPathsView",setup(f){const s=L();function m(t){return{confirmed:"danger",likely:"warning",theoretical:"info"}[t]||"secondary"}function p(t){console.log("View path:",t)}async function c(t){const i=await s.exportPath(t,"markdown");console.log("Export:",i)}function d(t){s.pagination.page=t.page+1,s.fetchPaths()}return z(()=>{s.fetchPaths(),s.fetchSummary()}),(t,i)=>(k(),x("div",N,[i[3]||(i[3]=o("div",{class:"page-header"},[o("div",{class:"header-content"},[o("h1",null,"Privilege Escalation Paths"),o("p",{class:"subtitle"},"IAM misconfigurations enabling privilege escalation")])],-1)),a(s).summary?(k(),x("div",T,[o("div",q,[o("div",D,w(a(s).summary.critical_paths),1),i[0]||(i[0]=o("div",{class:"card-label"},"Critical",-1))]),o("div",H,[o("div",J,w(a(s).summary.high_risk_paths),1),i[1]||(i[1]=o("div",{class:"card-label"},"High Risk",-1))]),o("div",K,[o("div",U,w(a(s).summary.total_paths),1),i[2]||(i[2]=o("div",{class:"card-label"},"Total",-1))])])):b("",!0),r(a(A),{value:a(s).paths,loading:a(s).loading,responsiveLayout:"scroll",class:"p-datatable-sm"},{default:y(()=>[r(a(v),{field:"escalation_method",header:"Method"}),r(a(v),{field:"source_principal_name",header:"Source"}),r(a(v),{field:"target_principal_name",header:"Target"}),r(a(v),{field:"cloud_provider",header:"Provider"}),r(a(v),{field:"risk_score",header:"Risk Score"},{body:y(({data:l})=>[r(a(I),{value:l.risk_score,showValue:!0,class:"risk-bar"},null,8,["value"])]),_:1}),r(a(v),{field:"exploitability",header:"Exploitability"},{body:y(({data:l})=>[r(a(F),{severity:m(l.exploitability),value:l.exploitability},null,8,["severity","value"])]),_:1}),r(a(v),{header:"Actions"},{body:y(({data:l})=>[r(a(S),{icon:"pi pi-eye",text:"",onClick:g=>p(l)},null,8,["onClick"]),r(a(S),{icon:"pi pi-download",text:"",onClick:g=>c(l.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),a(s).pagination.total>a(s).pagination.pageSize?(k(),j(a(B),{key:1,rows:a(s).pagination.pageSize,totalRecords:a(s).pagination.total,first:(a(s).pagination.page-1)*a(s).pagination.pageSize,onPage:d},null,8,["rows","totalRecords","first"])):b("",!0)]))}},W=V(G,[["__scopeId","data-v-bc124b84"]]);export{W as default};
