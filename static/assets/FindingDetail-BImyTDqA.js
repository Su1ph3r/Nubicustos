import{_ as $,C as T,r as L,c as p,q as y,a,o,z as c,e,p as g,t as d,x as b,n as R,F as x,b as S,A as N,m as P}from"./index-Dj79gJvW.js";const z={class:"poc-evidence"},F={key:0,class:"evidence-block"},V={class:"evidence-header"},D={class:"code-block"},j={key:1,class:"evidence-block"},M={class:"evidence-header"},O={class:"code-block command"},q={key:2,class:"evidence-block"},H={class:"evidence-header"},J=["href"],W={class:"screenshot-container"},U=["src","alt"],G={key:3,class:"no-evidence"},Y={__name:"PocEvidence",props:{finding:{type:Object,required:!0}},setup(n){const s=n,v=T(),m=L(!1),l=p(()=>{if(!s.finding.poc_evidence)return null;try{return JSON.parse(s.finding.poc_evidence)}catch{return s.finding.poc_evidence}}),i=p(()=>l.value?typeof l.value=="object"?JSON.stringify(l.value,null,2):l.value:""),f=p(()=>s.finding.poc_screenshot_path?s.finding.poc_screenshot_path.startsWith("http")?s.finding.poc_screenshot_path:`/reports/${s.finding.poc_screenshot_path}`:""),k=p(()=>s.finding.poc_evidence||s.finding.poc_verification||s.finding.poc_screenshot_path),h=async u=>{try{await navigator.clipboard.writeText(u),v.add({severity:"success",summary:"Copied",detail:"Copied to clipboard",life:2e3})}catch{v.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}},w=()=>{m.value=!0};return(u,t)=>{const C=y("Button");return o(),a("div",z,[l.value?(o(),a("div",F,[e("div",V,[t[2]||(t[2]=e("span",null,"Evidence",-1)),g(C,{icon:"pi pi-copy",size:"small",text:"",onClick:t[0]||(t[0]=A=>h(i.value))})]),e("div",D,[e("pre",null,d(i.value),1)])])):c("",!0),n.finding.poc_verification?(o(),a("div",j,[e("div",M,[t[3]||(t[3]=e("span",null,"Verification Command",-1)),g(C,{icon:"pi pi-copy",size:"small",text:"",onClick:t[1]||(t[1]=A=>h(n.finding.poc_verification))})]),e("div",O,[e("code",null,d(n.finding.poc_verification),1)])])):c("",!0),n.finding.poc_screenshot_path?(o(),a("div",q,[e("div",H,[t[5]||(t[5]=e("span",null,"Screenshot",-1)),e("a",{href:f.value,target:"_blank",class:"view-link"},[...t[4]||(t[4]=[e("i",{class:"pi pi-external-link"},null,-1),b(" View Full Size ",-1)])],8,J)]),e("div",W,[e("img",{src:f.value,alt:"Evidence for "+n.finding.title,onError:w},null,40,U)])])):c("",!0),k.value?c("",!0):(o(),a("div",G,[...t[6]||(t[6]=[e("i",{class:"pi pi-info-circle"},null,-1),b(" No proof of concept evidence available for this finding. ",-1)])]))])}}},K=$(Y,[["__scopeId","data-v-5e70f10c"]]),Q={class:"code-container"},X={key:0,class:"code-header"},Z={class:"language-label"},ee={class:"code-content"},ie={__name:"RemediationCode",props:{code:{type:String,required:!0},language:{type:String,default:"bash"},showHeader:{type:Boolean,default:!1}},setup(n){const s=n,v=T(),m=p(()=>`language-${s.language}`),l=p(()=>({terraform:"Terraform (HCL)",aws_cli:"AWS CLI",azure_cli:"Azure CLI",gcloud:"gcloud",kubectl:"kubectl",python:"Python",bash:"Bash",sh:"Shell",powershell:"PowerShell",cli:"CLI",json:"JSON",yaml:"YAML"})[s.language]||s.language),i=async()=>{try{await navigator.clipboard.writeText(s.code),v.add({severity:"success",summary:"Copied",detail:"Code copied to clipboard",life:2e3})}catch{v.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}};return(f,k)=>{const h=y("Button");return o(),a("div",Q,[n.showHeader?(o(),a("div",X,[e("span",Z,d(l.value),1),g(h,{icon:"pi pi-copy",size:"small",text:"",onClick:i,title:"Copy to clipboard"})])):c("",!0),e("div",ee,[e("pre",null,[e("code",{class:R(m.value)},d(n.code),3)])])])}}},E=$(ie,[["__scopeId","data-v-81d56461"]]),ne={class:"remediation-panel"},te={key:0,class:"remediation-section"},se={class:"remediation-text"},oe={key:1,class:"remediation-section"},ae={class:"commands-list"},de={class:"command-header"},le={key:0,class:"command-description"},ce={key:2,class:"remediation-section"},re={key:3,class:"remediation-section"},ue={class:"resources-list"},pe=["href"],ve={key:4,class:"no-remediation"},ge={__name:"RemediationPanel",props:{finding:{type:Object,required:!0}},setup(n){const s=n,v=T(),m=p(()=>s.finding.remediation_commands&&Array.isArray(s.finding.remediation_commands)&&s.finding.remediation_commands.length>0),l=p(()=>s.finding.remediation_code&&typeof s.finding.remediation_code=="object"&&Object.keys(s.finding.remediation_code).length>0),i=p(()=>s.finding.remediation_resources&&Array.isArray(s.finding.remediation_resources)&&s.finding.remediation_resources.length>0),f=p(()=>s.finding.remediation||m.value||l.value||i.value),k=u=>({terraform:"Terraform",aws_cli:"AWS CLI",azure_cli:"Azure CLI",gcloud:"Google Cloud CLI",kubectl:"kubectl",python:"Python",bash:"Bash",powershell:"PowerShell"})[u]||u.charAt(0).toUpperCase()+u.slice(1),h=u=>{const t={documentation:"pi pi-book",blog:"pi pi-file",video:"pi pi-video",github:"pi pi-github",default:"pi pi-link"};return t[u]||t.default},w=async u=>{try{await navigator.clipboard.writeText(u),v.add({severity:"success",summary:"Copied",detail:"Command copied to clipboard",life:2e3})}catch{v.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}};return(u,t)=>{const C=y("Tag"),A=y("Button"),I=y("TabPanel"),B=y("TabView");return o(),a("div",ne,[n.finding.remediation?(o(),a("div",te,[t[0]||(t[0]=e("h5",null,"Recommendation",-1)),e("p",se,d(n.finding.remediation),1)])):c("",!0),m.value?(o(),a("div",oe,[t[1]||(t[1]=e("h5",null,"Remediation Commands",-1)),e("div",ae,[(o(!0),a(x,null,S(n.finding.remediation_commands,(r,_)=>(o(),a("div",{key:_,class:"command-item"},[e("div",de,[g(C,{value:r.type||"command",severity:"info"},null,8,["value"]),r.description?(o(),a("span",le,d(r.description),1)):c("",!0),g(A,{icon:"pi pi-copy",size:"small",text:"",onClick:Ge=>w(r.command)},null,8,["onClick"])]),g(E,{code:r.command,language:r.type},null,8,["code","language"])]))),128))])])):c("",!0),l.value?(o(),a("div",ce,[t[2]||(t[2]=e("h5",null,"Code Snippets",-1)),g(B,null,{default:N(()=>[(o(!0),a(x,null,S(n.finding.remediation_code,(r,_)=>(o(),P(I,{key:_,header:k(_)},{default:N(()=>[g(E,{code:r,language:_},null,8,["code","language"])]),_:2},1032,["header"]))),128))]),_:1})])):c("",!0),i.value?(o(),a("div",re,[t[4]||(t[4]=e("h5",null,"Additional Resources",-1)),e("ul",ue,[(o(!0),a(x,null,S(n.finding.remediation_resources,(r,_)=>(o(),a("li",{key:_},[e("a",{href:r.url,target:"_blank",rel:"noopener noreferrer"},[e("i",{class:R(h(r.type))},null,2),b(" "+d(r.title)+" ",1),t[3]||(t[3]=e("i",{class:"pi pi-external-link"},null,-1))],8,pe)]))),128))])])):c("",!0),f.value?c("",!0):(o(),a("div",ve,[...t[5]||(t[5]=[e("i",{class:"pi pi-info-circle"},null,-1),b(" No specific remediation guidance available for this finding. ",-1),e("p",{class:"suggestion"}," Consider consulting the tool documentation or cloud provider best practices. ",-1)])]))])}}},me=$(ge,[["__scopeId","data-v-7a6b11e1"]]),fe={class:"finding-detail"},_e={class:"detail-section"},he={class:"description"},ye={class:"detail-section"},be={class:"detail-grid"},ke={class:"detail-item"},Ce={class:"value"},$e={class:"detail-item"},we={class:"value code"},Ae={class:"detail-item"},xe={class:"value"},Se={class:"detail-item"},Te={class:"value"},Ne={class:"detail-item"},Ee={class:"value"},Re={class:"detail-item"},Ie={class:"value"},Be={key:0,class:"detail-section"},Le={class:"detail-section"},Pe={class:"detail-section"},ze={class:"detail-grid"},Fe={class:"detail-item"},Ve={class:"value code small"},De={class:"detail-item"},je={class:"value"},Me={class:"detail-item"},Oe={class:"value"},qe={key:0,class:"detail-item"},He={class:"value"},Je={key:1,class:"detail-item"},We=["href"],Ue={__name:"FindingDetail",props:{finding:{type:Object,required:!0}},setup(n){const s=n,v=p(()=>s.finding.poc_evidence||s.finding.poc_verification||s.finding.poc_screenshot_path),m=l=>l?new Date(l).toLocaleString():"N/A";return(l,i)=>(o(),a("div",fe,[e("div",_e,[i[0]||(i[0]=e("h4",null,"Description",-1)),e("p",he,d(n.finding.description||"No description available"),1)]),e("div",ye,[i[7]||(i[7]=e("h4",null,"Resource Details",-1)),e("div",be,[e("div",ke,[i[1]||(i[1]=e("span",{class:"label"},"Resource Type:",-1)),e("span",Ce,d(n.finding.resource_type||"N/A"),1)]),e("div",$e,[i[2]||(i[2]=e("span",{class:"label"},"Resource ID:",-1)),e("span",we,d(n.finding.resource_id||"N/A"),1)]),e("div",Ae,[i[3]||(i[3]=e("span",{class:"label"},"Resource Name:",-1)),e("span",xe,d(n.finding.resource_name||"N/A"),1)]),e("div",Se,[i[4]||(i[4]=e("span",{class:"label"},"Region:",-1)),e("span",Te,d(n.finding.region||"N/A"),1)]),e("div",Ne,[i[5]||(i[5]=e("span",{class:"label"},"Account:",-1)),e("span",Ee,d(n.finding.account_id||"N/A"),1)]),e("div",Re,[i[6]||(i[6]=e("span",{class:"label"},"Tool:",-1)),e("span",Ie,d(n.finding.tool),1)])])]),v.value?(o(),a("div",Be,[i[8]||(i[8]=e("h4",null,[e("i",{class:"pi pi-eye"}),b(" Proof of Concept Evidence ")],-1)),g(K,{finding:n.finding},null,8,["finding"])])):c("",!0),e("div",Le,[i[9]||(i[9]=e("h4",null,[e("i",{class:"pi pi-wrench"}),b(" Remediation ")],-1)),g(me,{finding:n.finding},null,8,["finding"])]),e("div",Pe,[i[15]||(i[15]=e("h4",null,"Metadata",-1)),e("div",ze,[e("div",Fe,[i[10]||(i[10]=e("span",{class:"label"},"Finding ID:",-1)),e("span",Ve,d(n.finding.finding_id),1)]),e("div",De,[i[11]||(i[11]=e("span",{class:"label"},"First Seen:",-1)),e("span",je,d(m(n.finding.first_seen)),1)]),e("div",Me,[i[12]||(i[12]=e("span",{class:"label"},"Last Seen:",-1)),e("span",Oe,d(m(n.finding.last_seen)),1)]),n.finding.cvss_score?(o(),a("div",qe,[i[13]||(i[13]=e("span",{class:"label"},"CVSS Score:",-1)),e("span",He,d(n.finding.cvss_score),1)])):c("",!0),n.finding.cve_id?(o(),a("div",Je,[i[14]||(i[14]=e("span",{class:"label"},"CVE:",-1)),e("a",{href:`https://nvd.nist.gov/vuln/detail/${n.finding.cve_id}`,target:"_blank",class:"value link"},d(n.finding.cve_id),9,We)])):c("",!0)])])]))}},Ke=$(Ue,[["__scopeId","data-v-a0b0f808"]]);export{Ke as F};
