import{_ as w,D as T,r as D,c as p,y as k,a as o,o as t,f as l,e,x as _,t as d,B as g,n as E,F as C,b as $,A as N,q as L}from"./index-CSMvBwQo.js";const P={class:"poc-evidence"},F={key:0,class:"evidence-block"},z={class:"evidence-header"},V={class:"code-block"},j={key:1,class:"evidence-block"},M={class:"evidence-header"},O={class:"code-block command"},q={key:2,class:"evidence-block"},U={class:"evidence-header"},H=["href"],J={class:"screenshot-container"},W=["src","alt"],G={key:3,class:"no-evidence"},Y={__name:"PocEvidence",props:{finding:{type:Object,required:!0}},setup(n){const a=n,m=T(),h=D(!1),u=p(()=>{if(!a.finding.poc_evidence)return null;try{return JSON.parse(a.finding.poc_evidence)}catch{return a.finding.poc_evidence}}),r=p(()=>u.value?typeof u.value=="object"?JSON.stringify(u.value,null,2):u.value:""),i=p(()=>a.finding.poc_screenshot_path?a.finding.poc_screenshot_path.startsWith("http")?a.finding.poc_screenshot_path:`/reports/${a.finding.poc_screenshot_path}`:""),c=p(()=>a.finding.poc_evidence||a.finding.poc_verification||a.finding.poc_screenshot_path),y=async v=>{try{await navigator.clipboard.writeText(v),m.add({severity:"success",summary:"Copied",detail:"Copied to clipboard",life:2e3})}catch{m.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}},x=()=>{h.value=!0};return(v,s)=>{const A=k("Button");return t(),o("div",P,[u.value?(t(),o("div",F,[e("div",z,[s[2]||(s[2]=e("span",null,"Evidence",-1)),_(A,{icon:"pi pi-copy",size:"small",text:"",onClick:s[0]||(s[0]=S=>y(r.value))})]),e("div",V,[e("pre",null,d(r.value),1)])])):l("",!0),n.finding.poc_verification?(t(),o("div",j,[e("div",M,[s[3]||(s[3]=e("span",null,"Verification Command",-1)),_(A,{icon:"pi pi-copy",size:"small",text:"",onClick:s[1]||(s[1]=S=>y(n.finding.poc_verification))})]),e("div",O,[e("code",null,d(n.finding.poc_verification),1)])])):l("",!0),n.finding.poc_screenshot_path?(t(),o("div",q,[e("div",U,[s[5]||(s[5]=e("span",null,"Screenshot",-1)),e("a",{href:i.value,target:"_blank",class:"view-link"},[...s[4]||(s[4]=[e("i",{class:"pi pi-external-link"},null,-1),g(" View Full Size ",-1)])],8,H)]),e("div",J,[e("img",{src:i.value,alt:"Evidence for "+n.finding.title,onError:x},null,40,W)])])):l("",!0),c.value?l("",!0):(t(),o("div",G,[...s[6]||(s[6]=[e("i",{class:"pi pi-info-circle"},null,-1),g(" No proof of concept evidence available for this finding. ",-1)])]))])}}},K=w(Y,[["__scopeId","data-v-5e70f10c"]]),Q={class:"code-container"},X={key:0,class:"code-header"},Z={class:"language-label"},ee={class:"code-content"},ie={__name:"RemediationCode",props:{code:{type:String,required:!0},language:{type:String,default:"bash"},showHeader:{type:Boolean,default:!1}},setup(n){const a=n,m=T(),h=p(()=>`language-${a.language}`),u=p(()=>({terraform:"Terraform (HCL)",aws_cli:"AWS CLI",azure_cli:"Azure CLI",gcloud:"gcloud",kubectl:"kubectl",python:"Python",bash:"Bash",sh:"Shell",powershell:"PowerShell",cli:"CLI",json:"JSON",yaml:"YAML"})[a.language]||a.language),r=async()=>{try{await navigator.clipboard.writeText(a.code),m.add({severity:"success",summary:"Copied",detail:"Code copied to clipboard",life:2e3})}catch{m.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}};return(i,c)=>{const y=k("Button");return t(),o("div",Q,[n.showHeader?(t(),o("div",X,[e("span",Z,d(u.value),1),_(y,{icon:"pi pi-copy",size:"small",text:"",onClick:r,title:"Copy to clipboard"})])):l("",!0),e("div",ee,[e("pre",null,[e("code",{class:E(h.value)},d(n.code),3)])])])}}},R=w(ie,[["__scopeId","data-v-81d56461"]]),ne={class:"remediation-panel"},te={key:0,class:"remediation-section"},se={class:"remediation-text"},oe={key:1,class:"remediation-section"},ae={class:"commands-list"},de={class:"command-header"},le={key:0,class:"command-description"},ce={key:2,class:"remediation-section"},re={key:3,class:"remediation-section"},ue={class:"resources-list"},fe=["href"],ve={key:4,class:"no-remediation"},ge={__name:"RemediationPanel",props:{finding:{type:Object,required:!0}},setup(n){const a=n,m=T(),h=p(()=>a.finding.remediation_commands&&Array.isArray(a.finding.remediation_commands)&&a.finding.remediation_commands.length>0),u=p(()=>a.finding.remediation_code&&typeof a.finding.remediation_code=="object"&&Object.keys(a.finding.remediation_code).length>0),r=p(()=>a.finding.remediation_resources&&Array.isArray(a.finding.remediation_resources)&&a.finding.remediation_resources.length>0),i=p(()=>a.finding.remediation||h.value||u.value||r.value),c=v=>({terraform:"Terraform",aws_cli:"AWS CLI",azure_cli:"Azure CLI",gcloud:"Google Cloud CLI",kubectl:"kubectl",python:"Python",bash:"Bash",powershell:"PowerShell"})[v]||v.charAt(0).toUpperCase()+v.slice(1),y=v=>{const s={documentation:"pi pi-book",blog:"pi pi-file",video:"pi pi-video",github:"pi pi-github",default:"pi pi-link"};return s[v]||s.default},x=async v=>{try{await navigator.clipboard.writeText(v),m.add({severity:"success",summary:"Copied",detail:"Command copied to clipboard",life:2e3})}catch{m.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}};return(v,s)=>{const A=k("Tag"),S=k("Button"),I=k("TabPanel"),B=k("TabView");return t(),o("div",ne,[n.finding.remediation?(t(),o("div",te,[s[0]||(s[0]=e("h5",null,"Recommendation",-1)),e("p",se,d(n.finding.remediation),1)])):l("",!0),h.value?(t(),o("div",oe,[s[1]||(s[1]=e("h5",null,"Remediation Commands",-1)),e("div",ae,[(t(!0),o(C,null,$(n.finding.remediation_commands,(f,b)=>(t(),o("div",{key:b,class:"command-item"},[e("div",de,[_(A,{value:f.type||"command",severity:"info"},null,8,["value"]),f.description?(t(),o("span",le,d(f.description),1)):l("",!0),_(S,{icon:"pi pi-copy",size:"small",text:"",onClick:ai=>x(f.command)},null,8,["onClick"])]),_(R,{code:f.command,language:f.type},null,8,["code","language"])]))),128))])])):l("",!0),u.value?(t(),o("div",ce,[s[2]||(s[2]=e("h5",null,"Code Snippets",-1)),_(B,null,{default:N(()=>[(t(!0),o(C,null,$(n.finding.remediation_code,(f,b)=>(t(),L(I,{key:b,header:c(b)},{default:N(()=>[_(R,{code:f,language:b},null,8,["code","language"])]),_:2},1032,["header"]))),128))]),_:1})])):l("",!0),r.value?(t(),o("div",re,[s[4]||(s[4]=e("h5",null,"Additional Resources",-1)),e("ul",ue,[(t(!0),o(C,null,$(n.finding.remediation_resources,(f,b)=>(t(),o("li",{key:b},[e("a",{href:f.url,target:"_blank",rel:"noopener noreferrer"},[e("i",{class:E(y(f.type))},null,2),g(" "+d(f.title)+" ",1),s[3]||(s[3]=e("i",{class:"pi pi-external-link"},null,-1))],8,fe)]))),128))])])):l("",!0),i.value?l("",!0):(t(),o("div",ve,[...s[5]||(s[5]=[e("i",{class:"pi pi-info-circle"},null,-1),g(" No specific remediation guidance available for this finding. ",-1),e("p",{class:"suggestion"}," Consider consulting the tool documentation or cloud provider best practices. ",-1)])]))])}}},pe=w(ge,[["__scopeId","data-v-7a6b11e1"]]),me={class:"finding-detail"},_e={key:0,class:"detail-section tools-section"},he={class:"tool-badges"},ye={class:"detail-section"},be={class:"description"},ke={class:"detail-section"},Ce={class:"detail-grid"},$e={class:"detail-item"},Ae={class:"value"},we={class:"detail-item"},xe={class:"value code"},Se={class:"detail-item"},Te={class:"value"},Ne={class:"detail-item"},Re={class:"value"},Ee={class:"detail-item"},Ie={class:"value code"},Be={class:"detail-item"},De={class:"value"},Le={key:1,class:"detail-section"},Pe={class:"count-badge"},Fe={class:"affected-resources-list"},ze={class:"resource-id"},Ve={class:"resource-meta"},je={key:0},Me={key:1},Oe={key:2},qe={key:2,class:"detail-section"},Ue={class:"detail-section"},He={class:"detail-section metadata-section"},Je={class:"detail-grid"},We={class:"detail-item"},Ge={class:"value code small"},Ye={class:"detail-item"},Ke={class:"value"},Qe={class:"detail-item"},Xe={class:"value"},Ze={key:0,class:"detail-item"},ei={class:"value code small"},ii={key:1,class:"detail-item"},ni={class:"value"},ti={key:2,class:"detail-item"},si=["href"],oi={__name:"FindingDetail",props:{finding:{type:Object,required:!0}},setup(n){const a=n,m=p(()=>a.finding.poc_evidence||a.finding.poc_verification||a.finding.poc_screenshot_path),h=r=>r?new Date(r).toLocaleString():"N/A",u=r=>r?r.charAt(0).toUpperCase()+r.slice(1).replace(/_/g," "):"Unknown";return(r,i)=>(t(),o("div",me,[n.finding.tool_sources&&n.finding.tool_sources.length>0?(t(),o("div",_e,[i[0]||(i[0]=e("h4",null,[e("i",{class:"pi pi-search"}),g(" Detected By ")],-1)),e("div",he,[(t(!0),o(C,null,$(n.finding.tool_sources,c=>(t(),o("span",{key:c,class:"tool-badge"},d(u(c)),1))),128))])])):l("",!0),e("div",ye,[i[1]||(i[1]=e("h4",null,[e("i",{class:"pi pi-file-edit"}),g(" Description ")],-1)),e("p",be,d(n.finding.description||"No description available"),1)]),e("div",ke,[i[8]||(i[8]=e("h4",null,[e("i",{class:"pi pi-server"}),g(" Resource Details ")],-1)),e("div",Ce,[e("div",$e,[i[2]||(i[2]=e("span",{class:"label"},"Resource Type",-1)),e("span",Ae,d(n.finding.resource_type||"N/A"),1)]),e("div",we,[i[3]||(i[3]=e("span",{class:"label"},"Resource ID",-1)),e("span",xe,d(n.finding.resource_id||"N/A"),1)]),e("div",Se,[i[4]||(i[4]=e("span",{class:"label"},"Resource Name",-1)),e("span",Te,d(n.finding.resource_name||"N/A"),1)]),e("div",Ne,[i[5]||(i[5]=e("span",{class:"label"},"Region",-1)),e("span",Re,d(n.finding.region||"N/A"),1)]),e("div",Ee,[i[6]||(i[6]=e("span",{class:"label"},"Account ID",-1)),e("span",Ie,d(n.finding.account_id||"N/A"),1)]),e("div",Be,[i[7]||(i[7]=e("span",{class:"label"},"Tool",-1)),e("span",De,d(u(n.finding.tool)),1)])])]),n.finding.affected_resources&&n.finding.affected_resources.length>1?(t(),o("div",Le,[e("h4",null,[i[9]||(i[9]=e("i",{class:"pi pi-list"},null,-1)),i[10]||(i[10]=g(" Affected Resources ",-1)),e("span",Pe,d(n.finding.affected_count||n.finding.affected_resources.length),1)]),e("div",Fe,[(t(!0),o(C,null,$(n.finding.affected_resources,(c,y)=>(t(),o("div",{key:y,class:"affected-resource-item"},[e("div",ze,d(c.id),1),e("div",Ve,[c.name&&c.name!==c.id?(t(),o("span",je,d(c.name),1)):l("",!0),c.region?(t(),o("span",Me,d(c.region),1)):l("",!0),c.type?(t(),o("span",Oe,d(c.type),1)):l("",!0)])]))),128))])])):l("",!0),m.value?(t(),o("div",qe,[i[11]||(i[11]=e("h4",null,[e("i",{class:"pi pi-eye"}),g(" Proof of Concept Evidence ")],-1)),_(K,{finding:n.finding},null,8,["finding"])])):l("",!0),e("div",Ue,[i[12]||(i[12]=e("h4",null,[e("i",{class:"pi pi-wrench"}),g(" Remediation ")],-1)),_(pe,{finding:n.finding},null,8,["finding"])]),e("div",He,[i[19]||(i[19]=e("h4",null,[e("i",{class:"pi pi-info-circle"}),g(" Metadata ")],-1)),e("div",Je,[e("div",We,[i[13]||(i[13]=e("span",{class:"label"},"Finding ID",-1)),e("span",Ge,d(n.finding.finding_id),1)]),e("div",Ye,[i[14]||(i[14]=e("span",{class:"label"},"First Seen",-1)),e("span",Ke,d(h(n.finding.first_seen)),1)]),e("div",Qe,[i[15]||(i[15]=e("span",{class:"label"},"Last Seen",-1)),e("span",Xe,d(h(n.finding.last_seen)),1)]),n.finding.canonical_id?(t(),o("div",Ze,[i[16]||(i[16]=e("span",{class:"label"},"Canonical ID",-1)),e("span",ei,d(n.finding.canonical_id),1)])):l("",!0),n.finding.cvss_score?(t(),o("div",ii,[i[17]||(i[17]=e("span",{class:"label"},"CVSS Score",-1)),e("span",ni,d(n.finding.cvss_score),1)])):l("",!0),n.finding.cve_id?(t(),o("div",ti,[i[18]||(i[18]=e("span",{class:"label"},"CVE",-1)),e("a",{href:`https://nvd.nist.gov/vuln/detail/${n.finding.cve_id}`,target:"_blank",class:"value link"},d(n.finding.cve_id),9,si)])):l("",!0)])])]))}},li=w(oi,[["__scopeId","data-v-7a83c4f1"]]);export{li as F};
