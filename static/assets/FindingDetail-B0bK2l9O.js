import{_ as R,D as S,r as I,c as m,y as C,a as s,o as t,f as d,e,x as y,t as l,B as g,n as T,F as $,b as w,A as N,q as D,E as L}from"./index-CGJ-odjO.js";const F={class:"poc-evidence"},V={key:0,class:"evidence-block"},z={class:"evidence-header"},M={class:"code-block"},O={key:1,class:"evidence-block"},j={class:"evidence-header"},q={class:"code-block command"},U={key:2,class:"evidence-block"},H={class:"evidence-header"},J=["href"],W={class:"screenshot-container"},G=["src","alt"],Y={key:3,class:"no-evidence"},K={__name:"PocEvidence",props:{finding:{type:Object,required:!0}},setup(n){const a=n,f=S(),b=I(!1),p=m(()=>{if(!a.finding.poc_evidence)return null;try{return JSON.parse(a.finding.poc_evidence)}catch{return a.finding.poc_evidence}}),_=m(()=>p.value?typeof p.value=="object"?JSON.stringify(p.value,null,2):p.value:""),h=m(()=>a.finding.poc_screenshot_path?a.finding.poc_screenshot_path.startsWith("http")?a.finding.poc_screenshot_path:`/reports/${a.finding.poc_screenshot_path}`:""),u=m(()=>a.finding.poc_evidence||a.finding.poc_verification||a.finding.poc_screenshot_path),i=async r=>{try{await navigator.clipboard.writeText(r),f.add({severity:"success",summary:"Copied",detail:"Copied to clipboard",life:2e3})}catch{f.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}},c=()=>{b.value=!0};return(r,o)=>{const A=C("Button");return t(),s("div",F,[p.value?(t(),s("div",V,[e("div",z,[o[2]||(o[2]=e("span",null,"Evidence",-1)),y(A,{icon:"pi pi-copy",size:"small",text:"",onClick:o[0]||(o[0]=x=>i(_.value))})]),e("div",M,[e("pre",null,l(_.value),1)])])):d("",!0),n.finding.poc_verification?(t(),s("div",O,[e("div",j,[o[3]||(o[3]=e("span",null,"Verification Command",-1)),y(A,{icon:"pi pi-copy",size:"small",text:"",onClick:o[1]||(o[1]=x=>i(n.finding.poc_verification))})]),e("div",q,[e("code",null,l(n.finding.poc_verification),1)])])):d("",!0),n.finding.poc_screenshot_path?(t(),s("div",U,[e("div",H,[o[5]||(o[5]=e("span",null,"Screenshot",-1)),e("a",{href:h.value,target:"_blank",class:"view-link"},[...o[4]||(o[4]=[e("i",{class:"pi pi-external-link"},null,-1),g(" View Full Size ",-1)])],8,J)]),e("div",W,[e("img",{src:h.value,alt:"Evidence for "+n.finding.title,onError:c},null,40,G)])])):d("",!0),u.value?d("",!0):(t(),s("div",Y,[...o[6]||(o[6]=[e("i",{class:"pi pi-info-circle"},null,-1),g(" No proof of concept evidence available for this finding. ",-1)])]))])}}},Q=R(K,[["__scopeId","data-v-5e70f10c"]]),X={class:"code-container"},Z={key:0,class:"code-header"},ee={class:"language-label"},ie={class:"code-content"},ne={__name:"RemediationCode",props:{code:{type:String,required:!0},language:{type:String,default:"bash"},showHeader:{type:Boolean,default:!1}},setup(n){const a=n,f=S(),b=m(()=>`language-${a.language}`),p=m(()=>({terraform:"Terraform (HCL)",aws_cli:"AWS CLI",azure_cli:"Azure CLI",gcloud:"gcloud",kubectl:"kubectl",python:"Python",bash:"Bash",sh:"Shell",powershell:"PowerShell",cli:"CLI",json:"JSON",yaml:"YAML"})[a.language]||a.language),_=async()=>{try{await navigator.clipboard.writeText(a.code),f.add({severity:"success",summary:"Copied",detail:"Code copied to clipboard",life:2e3})}catch{f.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}};return(h,u)=>{const i=C("Button");return t(),s("div",X,[n.showHeader?(t(),s("div",Z,[e("span",ee,l(p.value),1),y(i,{icon:"pi pi-copy",size:"small",text:"",onClick:_,title:"Copy to clipboard"})])):d("",!0),e("div",ie,[e("pre",null,[e("code",{class:T(b.value)},l(n.code),3)])])])}}},E=R(ne,[["__scopeId","data-v-81d56461"]]),te={class:"remediation-panel"},se={key:0,class:"remediation-section"},oe={class:"remediation-text"},ae={key:1,class:"remediation-section"},le={class:"commands-list"},de={class:"command-header"},ce={key:0,class:"command-description"},re={key:2,class:"remediation-section"},ue={key:3,class:"remediation-section"},fe={class:"resources-list"},pe=["href"],ve={key:4,class:"no-remediation"},ge={__name:"RemediationPanel",props:{finding:{type:Object,required:!0}},setup(n){const a=n,f=S(),b=m(()=>a.finding.remediation_commands&&Array.isArray(a.finding.remediation_commands)&&a.finding.remediation_commands.length>0),p=m(()=>a.finding.remediation_code&&typeof a.finding.remediation_code=="object"&&Object.keys(a.finding.remediation_code).length>0),_=m(()=>a.finding.remediation_resources&&Array.isArray(a.finding.remediation_resources)&&a.finding.remediation_resources.length>0),h=m(()=>a.finding.remediation||b.value||p.value||_.value),u=r=>({terraform:"Terraform",aws_cli:"AWS CLI",azure_cli:"Azure CLI",gcloud:"Google Cloud CLI",kubectl:"kubectl",python:"Python",bash:"Bash",powershell:"PowerShell"})[r]||r.charAt(0).toUpperCase()+r.slice(1),i=r=>{const o={documentation:"pi pi-book",blog:"pi pi-file",video:"pi pi-video",github:"pi pi-github",default:"pi pi-link"};return o[r]||o.default},c=async r=>{try{await navigator.clipboard.writeText(r),f.add({severity:"success",summary:"Copied",detail:"Command copied to clipboard",life:2e3})}catch{f.add({severity:"error",summary:"Error",detail:"Failed to copy to clipboard",life:3e3})}};return(r,o)=>{const A=C("Tag"),x=C("Button"),B=C("TabPanel"),P=C("TabView");return t(),s("div",te,[n.finding.remediation?(t(),s("div",se,[o[0]||(o[0]=e("h5",null,"Recommendation",-1)),e("p",oe,l(n.finding.remediation),1)])):d("",!0),b.value?(t(),s("div",ae,[o[1]||(o[1]=e("h5",null,"Remediation Commands",-1)),e("div",le,[(t(!0),s($,null,w(n.finding.remediation_commands,(v,k)=>(t(),s("div",{key:k,class:"command-item"},[e("div",de,[y(A,{value:v.type||"command",severity:"info"},null,8,["value"]),v.description?(t(),s("span",ce,l(v.description),1)):d("",!0),y(x,{icon:"pi pi-copy",size:"small",text:"",onClick:pi=>c(v.command)},null,8,["onClick"])]),y(E,{code:v.command,language:v.type},null,8,["code","language"])]))),128))])])):d("",!0),p.value?(t(),s("div",re,[o[2]||(o[2]=e("h5",null,"Code Snippets",-1)),y(P,null,{default:N(()=>[(t(!0),s($,null,w(n.finding.remediation_code,(v,k)=>(t(),D(B,{key:k,header:u(k)},{default:N(()=>[y(E,{code:v,language:k},null,8,["code","language"])]),_:2},1032,["header"]))),128))]),_:1})])):d("",!0),_.value?(t(),s("div",ue,[o[4]||(o[4]=e("h5",null,"Additional Resources",-1)),e("ul",fe,[(t(!0),s($,null,w(n.finding.remediation_resources,(v,k)=>(t(),s("li",{key:k},[e("a",{href:v.url,target:"_blank",rel:"noopener noreferrer"},[e("i",{class:T(i(v.type))},null,2),g(" "+l(v.title)+" ",1),o[3]||(o[3]=e("i",{class:"pi pi-external-link"},null,-1))],8,pe)]))),128))])])):d("",!0),h.value?d("",!0):(t(),s("div",ve,[...o[5]||(o[5]=[e("i",{class:"pi pi-info-circle"},null,-1),g(" No specific remediation guidance available for this finding. ",-1),e("p",{class:"suggestion"}," Consider consulting the tool documentation or cloud provider best practices. ",-1)])]))])}}},me=R(ge,[["__scopeId","data-v-7a6b11e1"]]),_e={class:"finding-detail"},he={key:0,class:"detail-section tools-section"},ye={class:"tool-badges"},be={class:"detail-section"},ke={class:"description"},Ce={class:"detail-section"},$e={class:"detail-grid"},we={class:"detail-item"},Ae={class:"value"},Re={class:"detail-item"},xe={class:"value code"},Se={class:"detail-item"},Te={class:"value"},Ne={class:"detail-item"},Ee={class:"value"},Ie={class:"detail-item"},Be={class:"value code"},Pe={class:"detail-item"},De={class:"value"},Le={key:1,class:"detail-section"},Fe={class:"count-badge"},Ve={class:"affected-resources-list"},ze=["onClick"],Me={class:"resource-header"},Oe={class:"resource-id"},je={class:"resource-meta"},qe={key:0,class:"meta-tag"},Ue={key:1,class:"meta-tag region"},He={key:2,class:"meta-tag type"},Je={class:"poc-content"},We={key:0},Ge={key:1},Ye={key:2,class:"no-poc"},Ke={key:2,class:"detail-section"},Qe={class:"detail-section"},Xe={class:"detail-section metadata-section"},Ze={class:"detail-grid"},ei={class:"detail-item"},ii={class:"value code small"},ni={class:"detail-item"},ti={class:"value"},si={class:"detail-item"},oi={class:"value"},ai={key:0,class:"detail-item"},li={class:"value code small"},di={key:1,class:"detail-item"},ci={class:"value"},ri={key:2,class:"detail-item"},ui=["href"],fi={__name:"FindingDetail",props:{finding:{type:Object,required:!0}},setup(n){const a=n,f=I([]),b=u=>{const i=f.value.indexOf(u);i===-1?f.value.push(u):f.value.splice(i,1)},p=m(()=>a.finding.poc_evidence||a.finding.poc_verification||a.finding.poc_screenshot_path),_=u=>u?new Date(u).toLocaleString():"N/A",h=u=>u?u.charAt(0).toUpperCase()+u.slice(1).replace(/_/g," "):"Unknown";return(u,i)=>(t(),s("div",_e,[n.finding.tool_sources&&n.finding.tool_sources.length>0?(t(),s("div",he,[i[1]||(i[1]=e("h4",null,[e("i",{class:"pi pi-search"}),g(" Detected By ")],-1)),e("div",ye,[(t(!0),s($,null,w(n.finding.tool_sources,c=>(t(),s("span",{key:c,class:"tool-badge"},l(h(c)),1))),128))])])):d("",!0),e("div",be,[i[2]||(i[2]=e("h4",null,[e("i",{class:"pi pi-file-edit"}),g(" Description ")],-1)),e("p",ke,l(n.finding.description||"No description available"),1)]),e("div",Ce,[i[9]||(i[9]=e("h4",null,[e("i",{class:"pi pi-server"}),g(" Resource Details ")],-1)),e("div",$e,[e("div",we,[i[3]||(i[3]=e("span",{class:"label"},"Resource Type",-1)),e("span",Ae,l(n.finding.resource_type||"N/A"),1)]),e("div",Re,[i[4]||(i[4]=e("span",{class:"label"},"Resource ID",-1)),e("span",xe,l(n.finding.resource_id||"N/A"),1)]),e("div",Se,[i[5]||(i[5]=e("span",{class:"label"},"Resource Name",-1)),e("span",Te,l(n.finding.resource_name||"N/A"),1)]),e("div",Ne,[i[6]||(i[6]=e("span",{class:"label"},"Region",-1)),e("span",Ee,l(n.finding.region||"N/A"),1)]),e("div",Ie,[i[7]||(i[7]=e("span",{class:"label"},"Account ID",-1)),e("span",Be,l(n.finding.account_id||"N/A"),1)]),e("div",Pe,[i[8]||(i[8]=e("span",{class:"label"},"Tool",-1)),e("span",De,l(h(n.finding.tool)),1)])])]),n.finding.affected_resources&&n.finding.affected_resources.length>0?(t(),s("div",Le,[e("h4",null,[i[10]||(i[10]=e("i",{class:"pi pi-list"},null,-1)),i[11]||(i[11]=g(" Affected Resources ",-1)),e("span",Fe,l(n.finding.affected_count||n.finding.affected_resources.length),1)]),e("div",Ve,[(t(!0),s($,null,w(n.finding.affected_resources,(c,r)=>(t(),s("div",{key:r,class:"affected-resource-item clickable",onClick:o=>b(r)},[e("div",Me,[e("div",Oe,[e("i",{class:T(["pi pi-chevron-right",{expanded:f.value.includes(r)}])},null,2),g(" "+l(c.id),1)]),e("div",je,[c.name&&c.name!==c.id?(t(),s("span",qe,l(c.name),1)):d("",!0),c.region?(t(),s("span",Ue,l(c.region),1)):d("",!0),c.type?(t(),s("span",He,l(c.type),1)):d("",!0)])]),f.value.includes(r)?(t(),s("div",{key:0,class:"resource-poc",onClick:i[0]||(i[0]=L(()=>{},["stop"]))},[i[13]||(i[13]=e("h5",null,"Proof of Concept for this Resource",-1)),e("div",Je,[c.poc_output?(t(),s("pre",We,l(c.poc_output),1)):n.finding.poc_verification?(t(),s("p",Ge,[i[12]||(i[12]=e("strong",null,"Verification Command:",-1)),e("code",null,l(n.finding.poc_verification.replace("{resource_id}",c.id)),1)])):(t(),s("p",Ye," Run verification command to generate PoC for this specific resource. "))])])):d("",!0)],8,ze))),128))])])):d("",!0),p.value?(t(),s("div",Ke,[i[14]||(i[14]=e("h4",null,[e("i",{class:"pi pi-eye"}),g(" Proof of Concept Evidence ")],-1)),y(Q,{finding:n.finding},null,8,["finding"])])):d("",!0),e("div",Qe,[i[15]||(i[15]=e("h4",null,[e("i",{class:"pi pi-wrench"}),g(" Remediation ")],-1)),y(me,{finding:n.finding},null,8,["finding"])]),e("div",Xe,[i[22]||(i[22]=e("h4",null,[e("i",{class:"pi pi-info-circle"}),g(" Metadata ")],-1)),e("div",Ze,[e("div",ei,[i[16]||(i[16]=e("span",{class:"label"},"Finding ID",-1)),e("span",ii,l(n.finding.finding_id),1)]),e("div",ni,[i[17]||(i[17]=e("span",{class:"label"},"First Seen",-1)),e("span",ti,l(_(n.finding.first_seen)),1)]),e("div",si,[i[18]||(i[18]=e("span",{class:"label"},"Last Seen",-1)),e("span",oi,l(_(n.finding.last_seen)),1)]),n.finding.canonical_id?(t(),s("div",ai,[i[19]||(i[19]=e("span",{class:"label"},"Canonical ID",-1)),e("span",li,l(n.finding.canonical_id),1)])):d("",!0),n.finding.cvss_score?(t(),s("div",di,[i[20]||(i[20]=e("span",{class:"label"},"CVSS Score",-1)),e("span",ci,l(n.finding.cvss_score),1)])):d("",!0),n.finding.cve_id?(t(),s("div",ri,[i[21]||(i[21]=e("span",{class:"label"},"CVE",-1)),e("a",{href:`https://nvd.nist.gov/vuln/detail/${n.finding.cve_id}`,target:"_blank",class:"value link"},l(n.finding.cve_id),9,ui)])):d("",!0)])])]))}},gi=R(fi,[["__scopeId","data-v-6a961ed6"]]);export{gi as F};
