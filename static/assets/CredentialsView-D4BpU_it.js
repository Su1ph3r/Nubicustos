import{_ as W,N as $,D as B,r as m,c as A,j as Y,a,e,f as c,F as h,b as F,B as u,t as p,n as y,O as v,U as f,o as n}from"./index-D2tkqljB.js";const J={class:"credentials-view"},G={class:"main-content"},X={class:"provider-tabs"},H=["onClick"],Q={key:0,class:"profiles-section"},Z={class:"profiles-grid"},ee=["onClick"],se={class:"profile-header"},le={class:"profile-name"},te={key:0,class:"pi pi-check-circle profile-check"},ie={class:"profile-details"},ae={key:0,class:"profile-region"},ne={key:1,class:"profile-badge temp"},oe={key:0,class:"profile-selected-info"},re={key:1},ue={key:2,class:"credential-form"},de={class:"form-group"},ce={class:"form-group"},pe={class:"form-group"},ve={class:"form-group"},fe={key:3,class:"credential-form"},xe={class:"form-group"},me={class:"form-group"},_e={class:"form-group"},ye={class:"form-group"},ke={key:4,class:"credential-form"},ge={class:"form-group"},be={class:"form-group"},we={key:5,class:"credential-form"},Ce={class:"form-group"},Ve={class:"form-group"},Pe={class:"form-actions"},Se=["disabled"],Ae={key:0,class:"pi pi-spin pi-spinner"},je={key:1,class:"pi pi-shield"},ze={key:1,class:"results-section"},he={class:"results-code"},Fe={class:"code-block"},Ue={key:0,class:"results-details"},Ie={class:"detail-item"},De={class:"detail-value"},Ee={key:0,class:"detail-item"},Oe={class:"detail-value"},Ne={key:1,class:"detail-item"},Te={class:"detail-value success-text"},Ke={key:2,class:"detail-item"},Me={class:"detail-value error-text"},qe={key:1,class:"use-credentials-section"},Le={class:"use-credentials-content"},Re=["disabled"],We={key:2,class:"error-section"},$e="/api",Be={__name:"CredentialsView",setup(Ye){const g=$(),w=B(),t=m("aws"),b=m(!1),k=m(null),o=m(null),C=m(!1),j=m(null),V=A(()=>g.awsProfiles),P=A(()=>g.selectedAwsProfile);Y(async()=>{await g.fetchAwsProfiles()});async function U(i){b.value=!0,k.value=null,o.value=null;try{const s=await g.selectAwsProfile(i);s.success?(j.value=i,w.add({severity:"success",summary:"Profile Ready",detail:`AWS profile "${i}" verified and ready for scans`,life:4e3})):w.add({severity:"error",summary:"Verification Failed",detail:s.message||"Could not verify profile credentials",life:5e3})}catch(s){k.value=s.message,w.add({severity:"error",summary:"Error",detail:s.message,life:5e3})}finally{b.value=!1}}function I(){g.clearAwsProfile(),j.value=null,w.add({severity:"info",summary:"Profile Cleared",detail:"AWS profile selection cleared",life:3e3})}const D=[{id:"aws",name:"AWS"},{id:"azure",name:"Azure"},{id:"gcp",name:"GCP"},{id:"kubernetes",name:"Kubernetes"}],d=m({access_key_id:"",secret_access_key:"",session_token:"",region:"us-east-1"}),r=m({tenant_id:"",client_id:"",client_secret:"",subscription_id:""}),x=m({project_id:"",credentials_json:""}),_=m({kubeconfig:"",context:""}),E={aws:"pi pi-amazon",azure:"pi pi-microsoft",gcp:"pi pi-google",kubernetes:"pi pi-server"};function O(i){return E[i]||"pi pi-cloud"}function z(i){return{aws:"AWS",azure:"Azure",gcp:"GCP",kubernetes:"Kubernetes"}[i]||i}const N=A(()=>t.value==="aws"?d.value.access_key_id&&d.value.secret_access_key:t.value==="azure"?r.value.tenant_id&&r.value.client_id&&r.value.client_secret:t.value==="gcp"?x.value.project_id&&x.value.credentials_json:t.value==="kubernetes"?_.value.kubeconfig:!1);function T(i){t.value=i,o.value=null,k.value=null}function K(){t.value==="aws"?d.value={access_key_id:"",secret_access_key:"",session_token:"",region:"us-east-1"}:t.value==="azure"?r.value={tenant_id:"",client_id:"",client_secret:"",subscription_id:""}:t.value==="gcp"?x.value={project_id:"",credentials_json:""}:t.value==="kubernetes"&&(_.value={kubeconfig:"",context:""}),o.value=null,k.value=null}async function M(){b.value=!0,k.value=null,o.value=null;try{const i={provider:t.value};t.value==="aws"?i.aws={access_key_id:d.value.access_key_id,secret_access_key:d.value.secret_access_key,session_token:d.value.session_token||null,region:d.value.region||"us-east-1"}:t.value==="azure"?i.azure={tenant_id:r.value.tenant_id,client_id:r.value.client_id,client_secret:r.value.client_secret,subscription_id:r.value.subscription_id||null}:t.value==="gcp"?i.gcp={project_id:x.value.project_id,credentials_json:x.value.credentials_json}:t.value==="kubernetes"&&(i.kubernetes={kubeconfig:_.value.kubeconfig,context:_.value.context||null});const s=await fetch(`${$e}/credentials/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!s.ok){const l=await s.json();throw new Error(l.detail||"Verification failed")}o.value=await s.json()}catch(i){k.value=i.message}finally{b.value=!1}}function q(){var i;(i=o.value)!=null&&i.raw_output&&navigator.clipboard.writeText(o.value.raw_output)}const S=A(()=>g.getSessionCredentials(t.value)!==null);function L(){let i=null;t.value==="aws"?i={...d.value}:t.value==="azure"?i={...r.value}:t.value==="gcp"?i={...x.value}:t.value==="kubernetes"&&(i={..._.value}),i&&(g.setSessionCredentials(t.value,i),w.add({severity:"success",summary:"Credentials Ready",detail:`${z(t.value)} credentials stored for scan use`,life:4e3}))}return(i,s)=>(n(),a("div",J,[s[43]||(s[43]=e("div",{class:"page-header"},[e("h1",null,"Credential Verification"),e("p",{class:"subtitle"},"Verify cloud provider credentials and check permissions")],-1)),e("div",G,[e("div",X,[(n(),a(h,null,F(D,l=>e("button",{key:l.id,class:y(["provider-tab",{active:t.value===l.id}]),onClick:R=>T(l.id)},[e("i",{class:y(O(l.id))},null,2),e("span",null,p(l.name),1)],10,H)),64))]),t.value==="aws"&&V.value.length>0?(n(),a("div",Q,[s[19]||(s[19]=e("h3",null,[e("i",{class:"pi pi-folder"}),u(" AWS Profiles (from credentials file) ")],-1)),s[20]||(s[20]=e("p",{class:"profiles-description"}," Select a profile from your mounted AWS credentials file. This is the recommended approach. ",-1)),e("div",Z,[(n(!0),a(h,null,F(V.value,l=>(n(),a("div",{key:l.name,class:y(["profile-card",{selected:P.value===l.name,verified:j.value===l.name}]),onClick:R=>U(l.name)},[e("div",se,[s[13]||(s[13]=e("i",{class:"pi pi-user"},null,-1)),e("span",le,p(l.name),1),P.value===l.name?(n(),a("i",te)):c("",!0)]),e("div",ie,[l.region?(n(),a("span",ae,[s[14]||(s[14]=e("i",{class:"pi pi-globe"},null,-1)),u(" "+p(l.region),1)])):c("",!0),l.has_session_token?(n(),a("span",ne,"Temporary")):c("",!0)])],10,ee))),128))]),P.value?(n(),a("div",oe,[s[18]||(s[18]=e("i",{class:"pi pi-check-circle"},null,-1)),e("span",null,[s[15]||(s[15]=u("Profile ",-1)),e("strong",null,p(P.value),1),s[16]||(s[16]=u(" is ready for scans",-1))]),e("button",{class:"btn-clear-profile",onClick:I},[...s[17]||(s[17]=[e("i",{class:"pi pi-times"},null,-1),u(" Clear ",-1)])])])):c("",!0)])):c("",!0),e("div",{class:y(["form-section",{collapsed:t.value==="aws"&&V.value.length>0&&!C.value}])},[t.value==="aws"&&V.value.length>0?(n(),a("div",{key:0,class:"manual-toggle",onClick:s[0]||(s[0]=l=>C.value=!C.value)},[e("i",{class:y(C.value?"pi pi-chevron-down":"pi pi-chevron-right")},null,2),s[21]||(s[21]=e("span",null,"Or enter credentials manually",-1))])):(n(),a("h3",re,"Enter "+p(z(t.value))+" Credentials",1)),t.value==="aws"?(n(),a("div",ue,[e("div",de,[s[22]||(s[22]=e("label",{for:"aws-access-key"},[u("Access Key ID "),e("span",{class:"required"},"*")],-1)),v(e("input",{id:"aws-access-key","onUpdate:modelValue":s[1]||(s[1]=l=>d.value.access_key_id=l),type:"text",placeholder:"AKIAIOSFODNN7EXAMPLE",class:"form-input"},null,512),[[f,d.value.access_key_id]])]),e("div",ce,[s[23]||(s[23]=e("label",{for:"aws-secret-key"},[u("Secret Access Key "),e("span",{class:"required"},"*")],-1)),v(e("input",{id:"aws-secret-key","onUpdate:modelValue":s[2]||(s[2]=l=>d.value.secret_access_key=l),type:"password",placeholder:"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",class:"form-input"},null,512),[[f,d.value.secret_access_key]])]),e("div",pe,[s[24]||(s[24]=e("label",{for:"aws-session-token"},"Session Token (optional)",-1)),v(e("input",{id:"aws-session-token","onUpdate:modelValue":s[3]||(s[3]=l=>d.value.session_token=l),type:"password",placeholder:"For temporary credentials only",class:"form-input"},null,512),[[f,d.value.session_token]])]),e("div",ve,[s[25]||(s[25]=e("label",{for:"aws-region"},"Region",-1)),v(e("input",{id:"aws-region","onUpdate:modelValue":s[4]||(s[4]=l=>d.value.region=l),type:"text",placeholder:"us-east-1",class:"form-input"},null,512),[[f,d.value.region]])])])):c("",!0),t.value==="azure"?(n(),a("div",fe,[e("div",xe,[s[26]||(s[26]=e("label",{for:"azure-tenant"},[u("Tenant ID "),e("span",{class:"required"},"*")],-1)),v(e("input",{id:"azure-tenant","onUpdate:modelValue":s[5]||(s[5]=l=>r.value.tenant_id=l),type:"text",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",class:"form-input"},null,512),[[f,r.value.tenant_id]])]),e("div",me,[s[27]||(s[27]=e("label",{for:"azure-client"},[u("Client/App ID "),e("span",{class:"required"},"*")],-1)),v(e("input",{id:"azure-client","onUpdate:modelValue":s[6]||(s[6]=l=>r.value.client_id=l),type:"text",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",class:"form-input"},null,512),[[f,r.value.client_id]])]),e("div",_e,[s[28]||(s[28]=e("label",{for:"azure-secret"},[u("Client Secret "),e("span",{class:"required"},"*")],-1)),v(e("input",{id:"azure-secret","onUpdate:modelValue":s[7]||(s[7]=l=>r.value.client_secret=l),type:"password",placeholder:"Your client secret",class:"form-input"},null,512),[[f,r.value.client_secret]])]),e("div",ye,[s[29]||(s[29]=e("label",{for:"azure-subscription"},"Subscription ID (optional)",-1)),v(e("input",{id:"azure-subscription","onUpdate:modelValue":s[8]||(s[8]=l=>r.value.subscription_id=l),type:"text",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",class:"form-input"},null,512),[[f,r.value.subscription_id]])])])):c("",!0),t.value==="gcp"?(n(),a("div",ke,[e("div",ge,[s[30]||(s[30]=e("label",{for:"gcp-project"},[u("Project ID "),e("span",{class:"required"},"*")],-1)),v(e("input",{id:"gcp-project","onUpdate:modelValue":s[9]||(s[9]=l=>x.value.project_id=l),type:"text",placeholder:"my-project-123456",class:"form-input"},null,512),[[f,x.value.project_id]])]),e("div",be,[s[31]||(s[31]=e("label",{for:"gcp-json"},[u("Service Account JSON "),e("span",{class:"required"},"*")],-1)),v(e("textarea",{id:"gcp-json","onUpdate:modelValue":s[10]||(s[10]=l=>x.value.credentials_json=l),placeholder:`Paste your service account JSON key here...
{
  "type": "service_account",
  "project_id": "...",
  "private_key_id": "...",
  ...
}`,class:"form-textarea",rows:"10"},null,512),[[f,x.value.credentials_json]])])])):c("",!0),t.value==="kubernetes"?(n(),a("div",we,[e("div",Ce,[s[32]||(s[32]=e("label",{for:"k8s-kubeconfig"},[u("Kubeconfig YAML "),e("span",{class:"required"},"*")],-1)),v(e("textarea",{id:"k8s-kubeconfig","onUpdate:modelValue":s[11]||(s[11]=l=>_.value.kubeconfig=l),placeholder:`Paste your kubeconfig YAML content here...
apiVersion: v1
kind: Config
clusters:
- cluster:
    ...`,class:"form-textarea",rows:"12"},null,512),[[f,_.value.kubeconfig]])]),e("div",Ve,[s[33]||(s[33]=e("label",{for:"k8s-context"},"Context Name (optional)",-1)),v(e("input",{id:"k8s-context","onUpdate:modelValue":s[12]||(s[12]=l=>_.value.context=l),type:"text",placeholder:"Leave empty to use default context",class:"form-input"},null,512),[[f,_.value.context]])])])):c("",!0),e("div",Pe,[e("button",{class:"btn-verify",onClick:M,disabled:b.value||!N.value},[b.value?(n(),a("i",Ae)):(n(),a("i",je)),u(" "+p(b.value?"Verifying...":"Verify Credentials"),1)],8,Se),e("button",{class:"btn-clear",onClick:K},[...s[34]||(s[34]=[e("i",{class:"pi pi-times"},null,-1),u(" Clear ",-1)])])])],2),o.value?(n(),a("div",ze,[e("div",{class:y(["results-header",{success:o.value.success,error:!o.value.success}])},[e("i",{class:y(o.value.success?"pi pi-check-circle":"pi pi-times-circle")},null,2),e("span",null,p(o.value.success?"Credentials Verified":"Verification Failed"),1)],2),e("div",he,[e("div",{class:"code-header"},[s[36]||(s[36]=e("span",null,"Verification Output",-1)),e("button",{class:"btn-copy",onClick:q},[...s[35]||(s[35]=[e("i",{class:"pi pi-copy"},null,-1),u(" Copy ",-1)])])]),e("pre",Fe,p(o.value.raw_output),1)]),o.value.identity?(n(),a("div",Ue,[e("div",Ie,[s[37]||(s[37]=e("span",{class:"detail-label"},"Identity:",-1)),e("span",De,p(o.value.identity),1)]),o.value.account_info?(n(),a("div",Ee,[s[38]||(s[38]=e("span",{class:"detail-label"},"Account:",-1)),e("span",Oe,p(o.value.account_info),1)])):c("",!0),o.value.permissions_available.length>0?(n(),a("div",Ne,[s[39]||(s[39]=e("span",{class:"detail-label"},"Permissions OK:",-1)),e("span",Te,p(o.value.permissions_available.length),1)])):c("",!0),o.value.permissions_missing.length>0?(n(),a("div",Ke,[s[40]||(s[40]=e("span",{class:"detail-label"},"Permissions Denied:",-1)),e("span",Me,p(o.value.permissions_missing.length),1)])):c("",!0)])):c("",!0),o.value.success?(n(),a("div",qe,[e("div",Le,[s[41]||(s[41]=e("div",{class:"use-credentials-info"},[e("i",{class:"pi pi-check-circle"}),e("div",null,[e("strong",null,"Credentials Verified"),e("p",null,"Store these credentials in session memory for use during scans")])],-1)),e("button",{class:y(["btn-use-credentials",{active:S.value}]),onClick:L,disabled:S.value},[e("i",{class:y(S.value?"pi pi-check":"pi pi-bolt")},null,2),u(" "+p(S.value?"Ready for Scans":"Use for Scans"),1)],10,Re)])])):c("",!0)])):c("",!0),k.value?(n(),a("div",We,[s[42]||(s[42]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),e("span",null,p(k.value),1)])):c("",!0)])]))}},Ge=W(Be,[["__scopeId","data-v-cb79c3e4"]]);export{Ge as default};
